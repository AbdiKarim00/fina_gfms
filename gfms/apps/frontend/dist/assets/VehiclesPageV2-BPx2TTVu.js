import{j as e,a as N}from"./index-Bt2UjcLA.js";import{R as ie,a as c}from"./react-vendor-OZCXxi_L.js";import{q as z,r,s as M,t as ce,B as k,u as U,v as J,S as d,d as D,F as n,l as I,m as a,I as m,w as _,x as A,y as oe,z as v,j as de,T as K,E as ue,p as he,i as H,G as xe,H as me,J as O,K as je}from"./antd-vendor-OtDkfd4E.js";const pe=({vehicle:t,open:u,onClose:h,onEdit:b,onDelete:i})=>{if(!t)return null;const j=o=>{switch(o){case"active":return"success";case"maintenance":return"warning";case"inactive":return"default";default:return"default"}};return e.jsxs(z,{title:e.jsxs(d,{children:[e.jsx(D,{style:{color:"#006600"}}),e.jsx("span",{children:"Vehicle Details"})]}),open:u,onCancel:h,width:800,footer:[e.jsx(k,{onClick:h,children:"Close"},"close"),b&&e.jsx(k,{type:"primary",icon:e.jsx(U,{}),onClick:()=>b(t),children:"Edit"},"edit"),i&&e.jsx(k,{danger:!0,icon:e.jsx(J,{}),onClick:()=>i(t),children:"Delete"},"delete")],children:[e.jsxs(r,{bordered:!0,column:2,size:"small",children:[e.jsx(r.Item,{label:"Registration Number",span:2,children:e.jsx("strong",{style:{fontSize:"16px"},children:t.registration_number})}),e.jsx(r.Item,{label:"Make",children:t.make}),e.jsx(r.Item,{label:"Model",children:t.model}),e.jsx(r.Item,{label:"Year",children:t.year}),e.jsx(r.Item,{label:"Fuel Type",children:e.jsx(M,{color:"blue",children:t.fuel_type})}),e.jsx(r.Item,{label:"Status",span:2,children:e.jsx(M,{color:j(t.status),children:t.status.toUpperCase()})})]}),e.jsx(ce,{children:"Additional Information"}),e.jsxs(r,{bordered:!0,column:2,size:"small",children:[e.jsx(r.Item,{label:"Engine Number",children:t.engine_number||"N/A"}),e.jsx(r.Item,{label:"Chassis Number",children:t.chassis_number||"N/A"}),e.jsx(r.Item,{label:"Color",children:t.color||"N/A"}),e.jsx(r.Item,{label:"Mileage",children:t.mileage?`${t.mileage.toLocaleString()} km`:"N/A"}),e.jsx(r.Item,{label:"Capacity",children:t.capacity?`${t.capacity} passengers`:"N/A"}),e.jsx(r.Item,{label:"Purchase Year",children:t.purchase_year||"N/A"}),e.jsx(r.Item,{label:"Current Location",span:2,children:t.current_location||"N/A"}),e.jsx(r.Item,{label:"Responsible Officer",span:2,children:t.responsible_officer||"N/A"}),e.jsx(r.Item,{label:"Has Log Book",span:2,children:e.jsx(M,{color:t.has_log_book?"success":"error",children:t.has_log_book?"YES":"NO"})}),t.notes&&e.jsx(r.Item,{label:"Notes",span:2,children:t.notes})]})]})},{Option:f}=_,{TextArea:ge}=m,ye=({vehicle:t,open:u,onClose:h,onSuccess:b})=>{const[i]=n.useForm(),[j,o]=ie.useState(!1),p=!!t;c.useEffect(()=>{u&&t?i.setFieldsValue(t):u&&i.resetFields()},[u,t,i]);const g=async T=>{var V,w;try{o(!0),p?(await N.put(`/vehicles/${t.id}`,T),v.success("Vehicle updated successfully")):(await N.post("/vehicles",T),v.success("Vehicle added successfully")),i.resetFields(),b(),h()}catch(L){const F=((w=(V=L.response)==null?void 0:V.data)==null?void 0:w.message)||"Operation failed";v.error(F)}finally{o(!1)}},S=()=>{i.resetFields(),h()},x=new Date().getFullYear();return e.jsx(z,{title:e.jsxs("span",{children:[e.jsx(D,{style:{color:"#006600",marginRight:8}}),p?"Edit Vehicle":"Add New Vehicle"]}),open:u,onCancel:S,onOk:()=>i.submit(),confirmLoading:j,width:800,okText:p?"Update":"Add",cancelText:"Cancel",children:e.jsxs(n,{form:i,layout:"vertical",onFinish:g,initialValues:{status:"active",fuel_type:"petrol",has_log_book:!0},children:[e.jsxs(I,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(n.Item,{name:"registration_number",label:"Registration Number",rules:[{required:!0,message:"Please enter registration number"},{min:6,message:"Registration number must be at least 6 characters"},{max:15,message:"Registration number must not exceed 15 characters"}],children:e.jsx(m,{placeholder:"e.g., GKB 671S"})})}),e.jsx(a,{span:12,children:e.jsx(n.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:e.jsxs(_,{children:[e.jsx(f,{value:"active",children:"Active"}),e.jsx(f,{value:"maintenance",children:"Maintenance"}),e.jsx(f,{value:"inactive",children:"Inactive"}),e.jsx(f,{value:"disposed",children:"Disposed"})]})})})]}),e.jsxs(I,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(n.Item,{name:"make",label:"Make",rules:[{required:!0,message:"Please enter vehicle make"},{min:2,message:"Make must be at least 2 characters"}],children:e.jsx(m,{placeholder:"e.g., Toyota, Nissan, Land Rover"})})}),e.jsx(a,{span:12,children:e.jsx(n.Item,{name:"model",label:"Model",rules:[{required:!0,message:"Please enter vehicle model"},{min:2,message:"Model must be at least 2 characters"}],children:e.jsx(m,{placeholder:"e.g., Land Cruiser, Prado, X-Trail"})})})]}),e.jsxs(I,{gutter:16,children:[e.jsx(a,{span:8,children:e.jsx(n.Item,{name:"year",label:"Year",rules:[{required:!0,message:"Please enter year"},{type:"number",min:1990,message:"Year must be 1990 or later"},{type:"number",max:x+1,message:`Year cannot exceed ${x+1}`}],children:e.jsx(A,{style:{width:"100%"},placeholder:"e.g., 2020"})})}),e.jsx(a,{span:8,children:e.jsx(n.Item,{name:"fuel_type",label:"Fuel Type",rules:[{required:!0,message:"Please select fuel type"}],children:e.jsxs(_,{children:[e.jsx(f,{value:"petrol",children:"Petrol"}),e.jsx(f,{value:"diesel",children:"Diesel"}),e.jsx(f,{value:"electric",children:"Electric"}),e.jsx(f,{value:"hybrid",children:"Hybrid"})]})})}),e.jsx(a,{span:8,children:e.jsx(n.Item,{name:"color",label:"Color",children:e.jsx(m,{placeholder:"e.g., White, Black"})})})]}),e.jsxs(I,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(n.Item,{name:"engine_number",label:"Engine Number",children:e.jsx(m,{placeholder:"e.g., 1HZ-0879638"})})}),e.jsx(a,{span:12,children:e.jsx(n.Item,{name:"chassis_number",label:"Chassis Number",children:e.jsx(m,{placeholder:"e.g., JTELB71J50-7726026"})})})]}),e.jsxs(I,{gutter:16,children:[e.jsx(a,{span:8,children:e.jsx(n.Item,{name:"mileage",label:"Mileage (km)",rules:[{type:"number",min:0,message:"Mileage cannot be negative"},{type:"number",max:1e6,message:"Mileage seems too high"}],children:e.jsx(A,{style:{width:"100%"},placeholder:"e.g., 50000"})})}),e.jsx(a,{span:8,children:e.jsx(n.Item,{name:"capacity",label:"Capacity (passengers)",rules:[{type:"number",min:1,message:"Capacity must be at least 1"},{type:"number",max:100,message:"Capacity cannot exceed 100"}],children:e.jsx(A,{style:{width:"100%"},placeholder:"e.g., 5"})})}),e.jsx(a,{span:8,children:e.jsx(n.Item,{name:"purchase_year",label:"Purchase Year",children:e.jsx(A,{style:{width:"100%"},placeholder:"e.g., 2020",min:1990,max:x})})})]}),e.jsxs(I,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(n.Item,{name:"current_location",label:"Current Location",children:e.jsx(m,{placeholder:"e.g., POOL, CS OFFICE"})})}),e.jsx(a,{span:12,children:e.jsx(n.Item,{name:"responsible_officer",label:"Responsible Officer",children:e.jsx(m,{placeholder:"e.g., MULEI, Director RMD"})})})]}),e.jsx(n.Item,{name:"has_log_book",label:"Has Log Book",valuePropName:"checked",children:e.jsx(oe,{checkedChildren:"YES",unCheckedChildren:"NO"})}),e.jsx(n.Item,{name:"notes",label:"Notes",children:e.jsx(ge,{rows:3,placeholder:"Additional notes about the vehicle...",maxLength:500,showCount:!0})})]})})},{Text:C,Paragraph:be}=K,fe=({vehicle:t,open:u,onClose:h,onSuccess:b})=>{const[i,j]=c.useState(!1);if(!t)return null;const o=async()=>{var p,g;try{j(!0),await N.delete(`/vehicles/${t.id}`),v.success("Vehicle deleted successfully"),b(),h()}catch(S){const x=((g=(p=S.response)==null?void 0:p.data)==null?void 0:g.message)||"Failed to delete vehicle";v.error(x)}finally{j(!1)}};return e.jsx(z,{title:e.jsxs(d,{children:[e.jsx(ue,{style:{color:"#ff4d4f"}}),e.jsx("span",{children:"Delete Vehicle"})]}),open:u,onCancel:h,onOk:o,confirmLoading:i,okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},children:e.jsxs(d,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsx(de,{message:"Warning",description:"This action cannot be undone. The vehicle will be permanently deleted from the system.",type:"warning",showIcon:!0}),e.jsxs("div",{children:[e.jsx(be,{children:"Are you sure you want to delete the following vehicle?"}),e.jsxs(d,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(d,{children:[e.jsx(D,{style:{color:"#006600"}}),e.jsx(C,{strong:!0,children:"Registration:"}),e.jsx(C,{children:t.registration_number})]}),e.jsxs(d,{children:[e.jsx(C,{strong:!0,children:"Make & Model:"}),e.jsx(C,{children:`${t.make} ${t.model}`})]}),e.jsxs(d,{children:[e.jsx(C,{strong:!0,children:"Year:"}),e.jsx(C,{children:t.year})]}),e.jsxs(d,{children:[e.jsx(C,{strong:!0,children:"Status:"}),e.jsx(C,{children:t.status})]})]})]})]})})},{Title:Ce,Text:P}=K,{Option:y}=_,Se=()=>{const[t,u]=c.useState([]),[h,b]=c.useState([]),[i,j]=c.useState(!0),[o,p]=c.useState(""),[g,S]=c.useState("all"),[x,T]=c.useState("all"),[V,w]=c.useState(!1),[L,F]=c.useState(!1),[G,Y]=c.useState(!1),[$,R]=c.useState(null);c.useEffect(()=>{E()},[]),c.useEffect(()=>{W()},[t,o,g,x]);const E=async()=>{try{j(!0);const s=await N.get("/vehicles");u(s.data||[])}catch(s){console.error("Failed to fetch vehicles:",s)}finally{j(!1)}},W=()=>{let s=[...t];o&&(s=s.filter(l=>l.registration_number.toLowerCase().includes(o.toLowerCase())||l.make.toLowerCase().includes(o.toLowerCase())||l.model.toLowerCase().includes(o.toLowerCase()))),g!=="all"&&(s=s.filter(l=>l.status===g)),x!=="all"&&(s=s.filter(l=>l.fuel_type===x)),b(s)},X=s=>{p(s)},Z=s=>{S(s)},Q=s=>{T(s)},ee=()=>{p(""),S("all"),T("all")},se=s=>{R(s),w(!0)},te=()=>{R(null),F(!0)},B=s=>{R(s),w(!1),F(!0)},q=s=>{R(s),w(!1),Y(!0)},le=()=>{E()},ae=()=>{E()},re=s=>{switch(s){case"active":return"success";case"maintenance":return"warning";case"inactive":return"default";default:return"default"}},ne=[{title:"Registration",dataIndex:"registration_number",key:"registration_number",sorter:(s,l)=>s.registration_number.localeCompare(l.registration_number),render:s=>e.jsx(P,{strong:!0,children:s})},{title:"Make & Model",key:"make_model",render:(s,l)=>e.jsxs(d,{children:[e.jsx(D,{style:{color:"#006600"}}),e.jsx(P,{children:`${l.make} ${l.model}`})]}),sorter:(s,l)=>`${s.make} ${s.model}`.localeCompare(`${l.make} ${l.model}`)},{title:"Year",dataIndex:"year",key:"year",sorter:(s,l)=>s.year-l.year,width:100},{title:"Fuel Type",dataIndex:"fuel_type",key:"fuel_type",render:s=>e.jsx(M,{color:"blue",children:s})},{title:"Status",dataIndex:"status",key:"status",render:s=>e.jsx(M,{color:re(s),children:s.toUpperCase()})},{title:"Actions",key:"actions",width:150,render:(s,l)=>e.jsxs(d,{size:"small",children:[e.jsx(O,{title:"View Details",children:e.jsx(k,{type:"text",icon:e.jsx(je,{}),size:"small",onClick:()=>se(l)})}),e.jsx(O,{title:"Edit",children:e.jsx(k,{type:"text",icon:e.jsx(U,{}),size:"small",onClick:()=>B(l)})}),e.jsx(O,{title:"Delete",children:e.jsx(k,{type:"text",danger:!0,icon:e.jsx(J,{}),size:"small",onClick:()=>q(l)})})]})}];return e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(d,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(I,{justify:"space-between",align:"middle",children:[e.jsxs(a,{children:[e.jsx(Ce,{level:2,style:{margin:0},children:"Vehicles"}),e.jsx(P,{type:"secondary",children:"Manage your fleet vehicles including registration, maintenance, and status"})]}),e.jsx(a,{children:e.jsx(k,{type:"primary",icon:e.jsx(he,{}),size:"large",onClick:te,children:"Add Vehicle"})})]}),e.jsx(H,{children:e.jsxs(I,{gutter:[16,16],children:[e.jsx(a,{xs:24,sm:12,md:8,children:e.jsx(m,{placeholder:"Search by registration, make, or model",prefix:e.jsx(xe,{}),value:o,onChange:s=>X(s.target.value),allowClear:!0})}),e.jsx(a,{xs:24,sm:12,md:6,children:e.jsxs(_,{style:{width:"100%"},placeholder:"Filter by Status",value:g,onChange:Z,children:[e.jsx(y,{value:"all",children:"All Status"}),e.jsx(y,{value:"active",children:"Active"}),e.jsx(y,{value:"maintenance",children:"Maintenance"}),e.jsx(y,{value:"inactive",children:"Inactive"})]})}),e.jsx(a,{xs:24,sm:12,md:6,children:e.jsxs(_,{style:{width:"100%"},placeholder:"Filter by Fuel Type",value:x,onChange:Q,children:[e.jsx(y,{value:"all",children:"All Fuel Types"}),e.jsx(y,{value:"petrol",children:"Petrol"}),e.jsx(y,{value:"diesel",children:"Diesel"}),e.jsx(y,{value:"electric",children:"Electric"}),e.jsx(y,{value:"hybrid",children:"Hybrid"})]})}),e.jsx(a,{xs:24,sm:12,md:4,children:e.jsx(k,{onClick:ee,block:!0,children:"Reset Filters"})})]})}),e.jsx(H,{children:e.jsx(me,{columns:ne,dataSource:h,loading:i,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:s=>`Total ${s} vehicles`},locale:{emptyText:"No vehicles found. Add your first vehicle to get started."}})})]}),e.jsx(pe,{vehicle:$,open:V,onClose:()=>w(!1),onEdit:B,onDelete:q}),e.jsx(ye,{vehicle:$||void 0,open:L,onClose:()=>F(!1),onSuccess:le}),e.jsx(fe,{vehicle:$,open:G,onClose:()=>Y(!1),onSuccess:ae})]})};export{Se as VehiclesPageV2};
//# sourceMappingURL=VehiclesPageV2-BPx2TTVu.js.map
