var U=Object.defineProperty;var Q=(r,t,s)=>t in r?U(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var H=(r,t,s)=>Q(r,typeof t!="symbol"?t+"":t,s);import{j as e}from"./query-vendor-DQwqhezX.js";import{f as J,g as X,r as h,N as T,u as I,L as D,O as Y,h as Z,B as ee,i as te,j,R as se}from"./react-vendor-BEMtdQ9H.js";import{a as re}from"./utils-vendor-B9ygI19o.js";import{T as L,F as x,S as m,R as ne,C as v,A as R,I as A,a as ae,b as q,B as W,c as oe,d as P,e as ie}from"./ui-vendor-VQWSXWiY.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();var N={},_;function le(){if(_)return N;_=1;var r=J();return N.createRoot=r.createRoot,N.hydrateRoot=r.hydrateRoot,N}var ce=le();const de=X(ce),he="http://localhost:8000/api/v1";class xe{constructor(){H(this,"client");this.client=re.create({baseURL:he,headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0}),this.setupInterceptors()}setupInterceptors(){this.client.interceptors.request.use(t=>{const s=localStorage.getItem("auth_token");return s&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t)),this.client.interceptors.response.use(t=>t,t=>{var s;return((s=t.response)==null?void 0:s.status)===401&&(localStorage.removeItem("auth_token"),window.location.href="/login"),Promise.reject(t)})}async get(t,s){return(await this.client.get(t,s)).data}async post(t,s,a){return(await this.client.post(t,s,a)).data}async put(t,s,a){return(await this.client.put(t,s,a)).data}async delete(t,s){return(await this.client.delete(t,s)).data}}const B=new xe,G=h.createContext(void 0),me=({children:r})=>{const[t,s]=h.useState(null),[a,n]=h.useState(!0);h.useEffect(()=>{o()},[]);const o=async()=>{if(localStorage.getItem("auth_token"))try{const i=await B.get("/auth/me");s(i.data)}catch{localStorage.removeItem("auth_token")}n(!1)},l=async c=>{const i=await B.post("/auth/login",c);return{user_id:i.data.user_id,otp_channel:i.data.otp_channel,message:i.message}},g=async(c,i,d="email")=>{const p=await B.post("/auth/verify-otp",{user_id:c,code:i,otp_channel:d});localStorage.setItem("auth_token",p.data.token),s(p.data.user)},u=()=>{localStorage.removeItem("auth_token"),s(null)};return e.jsx(G.Provider,{value:{user:t,loading:a,login:l,verifyOtp:g,logout:u,isAuthenticated:!!t},children:r})},b=()=>{const r=h.useContext(G);if(!r)throw new Error("useAuth must be used within AuthProvider");return r},ge=({children:r})=>{const{isAuthenticated:t,loading:s}=b();return s?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):t?e.jsx(e.Fragment,{children:r}):e.jsx(T,{to:"/login",replace:!0})},ue=()=>{const{user:r,logout:t}=b(),s=I(),a=()=>{t(),s("/login")};return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("nav",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0 flex items-center",children:e.jsx("h1",{className:"text-xl font-bold text-blue-600",children:"GFMS"})}),e.jsxs("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[e.jsx(D,{to:"/dashboard",className:"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium",children:"Dashboard"}),e.jsx(D,{to:"/vehicles",className:"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium",children:"Vehicles"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm text-gray-700 mr-4",children:r==null?void 0:r.name}),e.jsx("button",{onClick:a,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded text-sm",children:"Logout"})]})]})})}),e.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsx(Y,{})})]})},{Title:V,Text:y}=L,pe=()=>{const[r,t]=h.useState(""),[s,a]=h.useState(!1),[n]=x.useForm(),{login:o}=b(),l=I(),g=async u=>{var c,i;t(""),a(!0);try{const d=await o(u);l("/verify-otp",{state:{userId:d.user_id,otpChannel:d.otp_channel,message:d.message}})}catch(d){if(console.error("Login error:",d),d instanceof Error){const p=d;console.error("Response:",p.response);const F=((i=(c=p.response)==null?void 0:c.data)==null?void 0:i.message)||d.message||"Login failed. Please try again.";t(F)}else t("Login failed. Please try again.")}finally{a(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center py-12 px-4",style:{background:"linear-gradient(135deg, #E8F5E9 0%, #FFFFFF 50%, #F1F8E9 100%)"},children:e.jsxs("div",{style:{maxWidth:450,width:"100%"},children:[e.jsxs(m,{direction:"vertical",size:"large",style:{width:"100%",marginBottom:32},align:"center",children:[e.jsx("div",{style:{width:80,height:80,background:"linear-gradient(135deg, #006600 0%, #009900 100%)",borderRadius:16,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(0, 102, 0, 0.2)"},children:e.jsx(ne,{style:{fontSize:48,color:"#FFFFFF"}})}),e.jsxs(m,{direction:"vertical",size:4,align:"center",children:[e.jsx(V,{level:2,style:{margin:0,color:"#000000"},children:"GFMS"}),e.jsx(y,{type:"secondary",style:{fontSize:14},children:"Kenya Government Fleet Management System"})]})]}),e.jsx(v,{style:{borderRadius:16,boxShadow:"0 4px 24px rgba(0, 0, 0, 0.08)"},children:e.jsxs(m,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsx(V,{level:4,style:{margin:0},children:"Sign in to your account"}),r&&e.jsx(R,{message:r,type:"error",showIcon:!0,closable:!0,onClose:()=>t("")}),e.jsxs(x,{form:n,name:"login",onFinish:g,layout:"vertical",size:"large",requiredMark:!1,children:[e.jsx(x.Item,{label:"Personal Number",name:"personal_number",rules:[{required:!0,message:"Please enter your personal number"},{pattern:/^\d+$/,message:"Personal number must contain only digits"}],children:e.jsx(A,{prefix:e.jsx(ae,{style:{color:"rgba(0,0,0,0.25)"}}),placeholder:"123456",autoComplete:"username"})}),e.jsx(x.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please enter your password"},{min:8,message:"Password must be at least 8 characters"}],children:e.jsx(A.Password,{prefix:e.jsx(q,{style:{color:"rgba(0,0,0,0.25)"}}),placeholder:"••••••••",autoComplete:"current-password"})}),e.jsx(x.Item,{style:{marginBottom:0},children:e.jsx(W,{type:"primary",htmlType:"submit",loading:s,block:!0,size:"large",style:{height:48,fontWeight:600},children:s?"Signing in...":"Sign in"})})]}),e.jsx(R,{message:e.jsxs(m,{size:"small",children:[e.jsx(y,{strong:!0,children:"Demo:"}),e.jsx(y,{code:!0,children:"123456"}),e.jsx(y,{type:"secondary",children:"/"}),e.jsx(y,{code:!0,children:"password"})]}),type:"info",showIcon:!0})]})}),e.jsx("div",{style:{marginTop:24,textAlign:"center"},children:e.jsx(y,{type:"secondary",style:{fontSize:12},children:"© 2025 Kenya Government. All rights reserved."})})]})})},{Title:je,Text:f,Link:C}=L,ye=()=>{var F,z,M;const[r,t]=h.useState(""),[s,a]=h.useState(!1),[n]=x.useForm(),{verifyOtp:o}=b(),l=I(),g=Z(),u=(F=g.state)==null?void 0:F.userId,c=((z=g.state)==null?void 0:z.otpChannel)||"email",i=(M=g.state)==null?void 0:M.message;h.useEffect(()=>{u||l("/login")},[u,l]);const d=async $=>{var E,O;t(""),a(!0);try{await o(u,$.code,c),l("/dashboard")}catch(w){if(console.error("OTP verification error:",w),w instanceof Error){const K=((O=(E=w.response)==null?void 0:E.data)==null?void 0:O.message)||w.message||"Invalid OTP. Please try again.";t(K)}else t("Invalid OTP. Please try again.")}finally{a(!1)}},p=()=>{console.log("Resend OTP")};return e.jsx("div",{className:"min-h-screen flex items-center justify-center py-12 px-4",style:{background:"linear-gradient(135deg, #E8F5E9 0%, #FFFFFF 50%, #F1F8E9 100%)"},children:e.jsxs("div",{style:{maxWidth:450,width:"100%"},children:[e.jsxs(m,{direction:"vertical",size:"large",style:{width:"100%",marginBottom:32},align:"center",children:[e.jsx("div",{style:{width:80,height:80,background:"linear-gradient(135deg, #006600 0%, #009900 100%)",borderRadius:16,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(0, 102, 0, 0.2)"},children:e.jsx(q,{style:{fontSize:48,color:"#FFFFFF"}})}),e.jsxs(m,{direction:"vertical",size:4,align:"center",children:[e.jsx(je,{level:2,style:{margin:0,color:"#000000"},children:"Verify OTP"}),e.jsxs(f,{type:"secondary",style:{fontSize:14},children:["Enter the code sent to your ",c]})]})]}),e.jsx(v,{style:{borderRadius:16,boxShadow:"0 4px 24px rgba(0, 0, 0, 0.08)"},children:e.jsxs(m,{direction:"vertical",size:"large",style:{width:"100%"},children:[i&&e.jsx(R,{message:i,type:"success",showIcon:!0}),r&&e.jsx(R,{message:r,type:"error",showIcon:!0,closable:!0,onClose:()=>t("")}),e.jsxs(x,{form:n,name:"verify-otp",onFinish:d,layout:"vertical",size:"large",requiredMark:!1,children:[e.jsx(x.Item,{label:"OTP Code",name:"code",rules:[{required:!0,message:"Please enter the OTP code"},{len:6,message:"OTP must be 6 digits"},{pattern:/^\d+$/,message:"OTP must contain only digits"}],children:e.jsx(A,{placeholder:"000000",maxLength:6,style:{fontSize:24,textAlign:"center",letterSpacing:"0.5em",fontFamily:"monospace"},autoComplete:"one-time-code"})}),e.jsx(x.Item,{style:{marginBottom:0},children:e.jsx(W,{type:"primary",htmlType:"submit",loading:s,block:!0,size:"large",style:{height:48,fontWeight:600},children:s?"Verifying...":"Verify OTP"})})]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsxs(m,{split:e.jsx(f,{type:"secondary",children:"•"}),children:[e.jsx(C,{onClick:p,children:"Resend OTP"}),e.jsx(C,{onClick:()=>l("/login"),children:"Back to Login"})]})})]})}),e.jsx("div",{style:{marginTop:24,textAlign:"center"},children:e.jsxs(m,{direction:"vertical",size:8,children:[e.jsxs(f,{type:"secondary",style:{fontSize:12},children:["Check your ",c==="email"?"email inbox":"phone messages"," for the OTP code"]}),c==="email"&&e.jsxs(f,{type:"secondary",style:{fontSize:12},children:["Dev Mode: ",e.jsx(C,{href:"http://localhost:8000/otp-viewer.html",target:"_blank",children:"Open OTP Viewer"})]})]})}),e.jsx("div",{style:{marginTop:24,textAlign:"center"},children:e.jsx(f,{type:"secondary",style:{fontSize:12},children:"© 2025 Kenya Government. All rights reserved."})})]})})},fe=()=>{const{user:r}=b();return e.jsxs("div",{className:"px-4 py-6 sm:px-0",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["Welcome back, ",r==null?void 0:r.name,"!"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Vehicles"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:"2"})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Drivers"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:"1"})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending Bookings"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:"0"})]})})]})})})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("button",{className:"bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow text-left",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Add Vehicle"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Register a new vehicle"})]}),e.jsxs("button",{className:"bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow text-left",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Book Vehicle"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create a new booking"})]}),e.jsxs("button",{className:"bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow text-left",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Add Driver"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Register a new driver"})]}),e.jsxs("button",{className:"bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow text-left",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"View Reports"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Generate fleet reports"})]})]})]})]})},{Title:S,Paragraph:k}=L,ve=()=>e.jsxs("div",{className:"vehicles-page",children:[e.jsx(S,{level:2,children:"Vehicle Management"}),e.jsx(k,{children:"This page will display vehicle management functionality for fleet managers."}),e.jsxs(oe,{gutter:[16,16],children:[e.jsx(P,{span:8,children:e.jsxs(v,{title:"Total Vehicles",bordered:!1,children:[e.jsx(S,{level:3,children:"125"}),e.jsx(k,{children:"All vehicles in the fleet"})]})}),e.jsx(P,{span:8,children:e.jsxs(v,{title:"Active Vehicles",bordered:!1,children:[e.jsx(S,{level:3,children:"112"}),e.jsx(k,{children:"Vehicles currently in service"})]})}),e.jsx(P,{span:8,children:e.jsxs(v,{title:"Maintenance Due",bordered:!1,children:[e.jsx(S,{level:3,children:"8"}),e.jsx(k,{children:"Vehicles requiring maintenance"})]})})]})]}),be={token:{colorPrimary:"#006600",colorSuccess:"#006600",colorWarning:"#FF0000",colorError:"#FF0000",colorInfo:"#0D6EFD",colorLink:"#006600",fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',fontSize:14,fontSizeHeading1:38,fontSizeHeading2:30,fontSizeHeading3:24,fontSizeHeading4:20,fontSizeHeading5:16,borderRadius:8,controlHeight:40,colorBgContainer:"#FFFFFF",colorBgLayout:"#F5F5F5",colorBgElevated:"#FFFFFF",colorBorder:"#D9D9D9",colorBorderSecondary:"#F0F0F0",colorText:"#000000",colorTextSecondary:"rgba(0, 0, 0, 0.65)",colorTextTertiary:"rgba(0, 0, 0, 0.45)",colorTextQuaternary:"rgba(0, 0, 0, 0.25)"},components:{Layout:{headerBg:"#FFFFFF",headerHeight:64,headerPadding:"0 24px",headerColor:"#000000",siderBg:"#001529",bodyBg:"#F5F5F5",footerBg:"#FAFAFA",footerPadding:"24px 50px"},Menu:{darkItemBg:"#001529",darkItemSelectedBg:"#006600",darkItemHoverBg:"rgba(0, 102, 0, 0.2)",itemBorderRadius:8},Button:{controlHeight:40,controlHeightLG:48,controlHeightSM:32,borderRadius:8,borderRadiusLG:8,borderRadiusSM:6,fontWeight:500},Input:{controlHeight:40,controlHeightLG:48,controlHeightSM:32,borderRadius:8,paddingBlock:8,paddingInline:12},Select:{controlHeight:40,borderRadius:8},Table:{headerBg:"#FAFAFA",headerColor:"#000000",headerSortActiveBg:"#F0F0F0",headerSortHoverBg:"#F5F5F5",borderRadius:8,rowHoverBg:"#F5F5F5"},Card:{borderRadius:12,boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.03), 0 1px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px 0 rgba(0, 0, 0, 0.02)"},Modal:{borderRadius:12,headerBg:"#FFFFFF"},Drawer:{borderRadius:0},Form:{labelFontSize:14,labelColor:"rgba(0, 0, 0, 0.85)",itemMarginBottom:24},Tabs:{itemActiveColor:"#006600",itemHoverColor:"#006600",itemSelectedColor:"#006600",inkBarColor:"#006600"},Badge:{dotSize:8},Tag:{borderRadius:6},Alert:{borderRadius:8},Message:{contentBg:"#FFFFFF",borderRadius:8},Notification:{borderRadius:8}}},Fe=()=>e.jsx(ie,{theme:be,children:e.jsx(ee,{children:e.jsx(me,{children:e.jsxs(te,{children:[e.jsx(j,{path:"/login",element:e.jsx(pe,{})}),e.jsx(j,{path:"/verify-otp",element:e.jsx(ye,{})}),e.jsxs(j,{path:"/",element:e.jsx(ge,{children:e.jsx(ue,{})}),children:[e.jsx(j,{index:!0,element:e.jsx(T,{to:"/dashboard",replace:!0})}),e.jsx(j,{path:"dashboard",element:e.jsx(fe,{})}),e.jsx(j,{path:"vehicles",element:e.jsx(ve,{})})]}),e.jsx(j,{path:"*",element:e.jsx(T,{to:"/dashboard",replace:!0})})]})})})});de.createRoot(document.getElementById("root")).render(e.jsx(se.StrictMode,{children:e.jsx(Fe,{})}));
//# sourceMappingURL=index-LkV7khh9.js.map
