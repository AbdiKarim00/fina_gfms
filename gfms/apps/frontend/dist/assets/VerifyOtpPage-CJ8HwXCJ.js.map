{"version":3,"file":"VerifyOtpPage-CJ8HwXCJ.js","sources":["../../src/pages/VerifyOtpPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { Form, Input, Button, Alert, Card, Typography, Space } from 'antd';\nimport { LockOutlined } from '@ant-design/icons';\nimport { useAuth } from '../contexts/AuthContext';\n\nconst { Title, Text, Link } = Typography;\n\nexport const VerifyOtpPage: React.FC = () => {\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [form] = Form.useForm();\n  const { verifyOtp } = useAuth();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const userId = location.state?.userId;\n  const otpChannel = location.state?.otpChannel || 'email';\n  const message = location.state?.message;\n\n  useEffect(() => {\n    if (!userId) {\n      navigate('/login');\n    }\n  }, [userId, navigate]);\n\n  const handleSubmit = async (values: { code: string }) => {\n    setError('');\n    setLoading(true);\n\n    try {\n      await verifyOtp(userId, values.code, otpChannel);\n      navigate('/dashboard');\n    } catch (err: any) {\n      console.error('OTP verification error:', err);\n      const errorMessage = err.response?.data?.message || err.message || 'Invalid OTP. Please try again.';\n      setError(errorMessage);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleResendOtp = () => {\n    // TODO: Implement resend OTP functionality\n    console.log('Resend OTP');\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center py-12 px-4\" style={{ background: 'linear-gradient(135deg, #E8F5E9 0%, #FFFFFF 50%, #F1F8E9 100%)' }}>\n      <div style={{ maxWidth: 450, width: '100%' }}>\n        {/* Logo/Header Section */}\n        <Space direction=\"vertical\" size=\"large\" style={{ width: '100%', marginBottom: 32 }} align=\"center\">\n          <div style={{ \n            width: 80, \n            height: 80, \n            background: 'linear-gradient(135deg, #006600 0%, #009900 100%)',\n            borderRadius: 16,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            boxShadow: '0 4px 12px rgba(0, 102, 0, 0.2)'\n          }}>\n            <LockOutlined style={{ fontSize: 48, color: '#FFFFFF' }} />\n          </div>\n          <Space direction=\"vertical\" size={4} align=\"center\">\n            <Title level={2} style={{ margin: 0, color: '#000000' }}>Verify OTP</Title>\n            <Text type=\"secondary\" style={{ fontSize: 14 }}>\n              Enter the code sent to your {otpChannel}\n            </Text>\n          </Space>\n        </Space>\n\n        {/* OTP Card */}\n        <Card \n          style={{ \n            borderRadius: 16,\n            boxShadow: '0 4px 24px rgba(0, 0, 0, 0.08)'\n          }}\n        >\n          <Space direction=\"vertical\" size=\"large\" style={{ width: '100%' }}>\n            {message && (\n              <Alert\n                message={message}\n                type=\"success\"\n                showIcon\n              />\n            )}\n\n            {error && (\n              <Alert\n                message={error}\n                type=\"error\"\n                showIcon\n                closable\n                onClose={() => setError('')}\n              />\n            )}\n\n            <Form\n              form={form}\n              name=\"verify-otp\"\n              onFinish={handleSubmit}\n              layout=\"vertical\"\n              size=\"large\"\n              requiredMark={false}\n            >\n              <Form.Item\n                label=\"OTP Code\"\n                name=\"code\"\n                rules={[\n                  { required: true, message: 'Please enter the OTP code' },\n                  { len: 6, message: 'OTP must be 6 digits' },\n                  { pattern: /^\\d+$/, message: 'OTP must contain only digits' }\n                ]}\n              >\n                <Input\n                  placeholder=\"000000\"\n                  maxLength={6}\n                  style={{ \n                    fontSize: 24, \n                    textAlign: 'center', \n                    letterSpacing: '0.5em',\n                    fontFamily: 'monospace'\n                  }}\n                  autoComplete=\"one-time-code\"\n                />\n              </Form.Item>\n\n              <Form.Item style={{ marginBottom: 0 }}>\n                <Button\n                  type=\"primary\"\n                  htmlType=\"submit\"\n                  loading={loading}\n                  block\n                  size=\"large\"\n                  style={{ height: 48, fontWeight: 600 }}\n                >\n                  {loading ? 'Verifying...' : 'Verify OTP'}\n                </Button>\n              </Form.Item>\n            </Form>\n\n            {/* Helper Links */}\n            <div style={{ textAlign: 'center' }}>\n              <Space split={<Text type=\"secondary\">•</Text>}>\n                <Link onClick={handleResendOtp}>Resend OTP</Link>\n                <Link onClick={() => navigate('/login')}>Back to Login</Link>\n              </Space>\n            </div>\n          </Space>\n        </Card>\n\n        {/* Helper Text */}\n        <div style={{ marginTop: 24, textAlign: 'center' }}>\n          <Space direction=\"vertical\" size={8}>\n            <Text type=\"secondary\" style={{ fontSize: 12 }}>\n              Check your {otpChannel === 'email' ? 'email inbox' : 'phone messages'} for the OTP code\n            </Text>\n            {otpChannel === 'email' && (\n              <Text type=\"secondary\" style={{ fontSize: 12 }}>\n                Dev Mode: <Link href=\"http://localhost:8000/otp-viewer.html\" target=\"_blank\">Open OTP Viewer</Link>\n              </Text>\n            )}\n          </Space>\n        </div>\n\n        {/* Footer */}\n        <div style={{ marginTop: 24, textAlign: 'center' }}>\n          <Text type=\"secondary\" style={{ fontSize: 12 }}>\n            © 2025 Kenya Government. All rights reserved.\n          </Text>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"names":["Title","Text","Link","Typography","VerifyOtpPage","error","setError","useState","loading","setLoading","form","Form","verifyOtp","useAuth","navigate","useNavigate","location","useLocation","userId","_a","otpChannel","_b","message","_c","useEffect","handleSubmit","values","err","errorMessage","handleResendOtp","jsxs","Space","jsx","LockOutlined","Card","Alert","Input","Button"],"mappings":"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"}